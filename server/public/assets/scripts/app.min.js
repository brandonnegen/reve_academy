/*! reve_test 2015-09-28 */
var reveApp=angular.module("reveApp",["ngRoute","chart.js","appControllers","ngCookies","ngAnimate"]);reveApp.directive("sameAs",function(){return{require:"ngModel",link:function(a,b,c,d){var e=c.sameAs;a.$watch(c.sameAs,function(){d.$validate()}),d.$validators.match=function(b,c){return c===a.$eval(e)}}}}),reveApp.factory("AuthService",["$q","$timeout","$http","$cookies","$rootScope",function(a,b,c,d,e){function f(){return m}function g(){var a=d.getObject("userinfo");console.log("here is the log",a)}function h(){return n?!0:!1}function i(a){return!a||null!==n&&1==a||-1!==m.indexOf(a)}function j(){return n}function k(b,f){var g=a.defer();return c.post("/login",{username:b,password:f}).success(function(a,b){200===b&&a.status?(e.currentUser=d.getObject("userinfo"),m=e.currentUser.role,n=!0,g.resolve()):(n=!1,g.reject())}).error(function(a){console.log("error"),n=!1,g.reject()}),g.promise}function l(){var b=a.defer();return c.get("/logout").success(function(a){n=!1,d.remove("userinfo"),b.resolve()}).error(function(a){n=!1,b.reject()}),b.promise}var m,n=!1;return{authorize:i,isLoggedIn:h,getUserStatus:j,login:k,logout:l,user:n,getCurrentUser:f,getCookie:g}}]),reveApp.run(["$rootScope","$location","$route","AuthService",function(a,b,c,d){a.$on("$routeChangeStart",function(a,c,e){d.authorize(c.security)||(d.isLoggedIn()?b.path("/unauthorized"):(b.path("/login"),console.log("ah ah ah, you didnt say the magic word")))})}]);var appControllers=angular.module("appControllers",[]);reveApp.config(["$routeProvider",function(a,b){a.when("/admin",{controller:"AdminController",access:{restricted:!0},security:"Admin",templateUrl:"assets/views/admin.html",activetab:"admin"}).when("/teachers",{controller:"TeacherClassesController",templateUrl:"assets/views/teacher-classes.html",activetab:"teacher-classes",access:{restricted:!0},security:!0}).when("/login",{controller:"LoginController",templateUrl:"assets/views/login.html",activetab:"login",access:{restricted:!1},security:!1}).when("/register",{controller:"RegisterController",templateUrl:"assets/views/register.html",activetab:"register",access:{restricted:!1},security:!1}).when("/schools",{controller:"SchoolController",templateUrl:"assets/views/schools.html",activetab:"schools",access:{restricted:!0},security:"Admin"}).when("/admin-teachers",{controller:"AdminTeachersController",templateUrl:"assets/views/admin-teachers.html",activetab:"admin-teachers",access:{restricted:!0},security:"Admin"}).when("/admin-classes",{controller:"AdminClassesController",templateUrl:"assets/views/admin-classes.html",activetab:"admin-classes",access:{restricted:!0},security:"Admin"}).when("/admin-assignments",{controller:"AdminAssignmentsController",templateUrl:"assets/views/admin-assignments.html",activetab:"admin-assignments",access:{restricted:!0},security:"Admin"}).when("/admin-students",{controller:"AdminStudentsController",templateUrl:"assets/views/admin-students.html",activetab:"admin-students",access:{restricted:!0},security:"Admin"}).when("/teacher-classes",{controller:"TeacherClassesController",templateUrl:"assets/views/teacher-classes.html",activetab:"teacher-classes",access:{restricted:!0},security:!0}).when("/teacher-students",{controller:"TeacherStudentsController",templateUrl:"assets/views/teacher-students.html",activetab:"teacher-students",access:{restricted:!0},security:!0}).when("/unauthorized",{templateUrl:"assets/views/unauthorized.html",access:{restricted:!1}}).when("/charts",{controller:"ChartsController",templateUrl:"assets/views/charts.html",activetab:"charts",access:{restricted:!0}}).otherwise({redirectTo:"/login"})}]);